{% extends "layout.html" %}
{% set title = 'Site Cameras' -%}
{% set active_page = 'extcams' -%}
{% block body %}
<div class="dashhead m-b">
  <div class="dashhead-titles">
    <h2 class="dashhead-title">{{ title|safe }}</h2>
    <h2 class="dashhead-subtitle">Automatically updates every 10 seconds</h2>
  </div>
</div>

{% if user_account != None and 'onemetre' in user_account['permissions'] %}
<div class="row">
  <div class="col-md-6">
    <img src="/webcam/ext1/static" data-url="/webcam/ext1/static" width="100%">
  </div>
  <div class="col-md-6">
    <img src="/webcam/ext2/static" data-url="/webcam/ext2/static" width="100%">
  </div>
</div>

<script>
function reloadImages() {
  $('img').each(function() {
    var url = $(this).data('url');
    if (url) {
      var sep = url.indexOf('?') < 0 ? '?' : '&';
      $(this).attr('src', url + sep + Date.now());
    }
  });
}

$(document).ready(function () {
  window.setInterval(reloadImages, 10000)
});
</script>
{% else %}
<div class="row">
  <div class="col-md-12">
    <div class="list-group m-b">
      <h5 class="list-group-header text-center">Authentication Required</h5>
      <span class="list-group-item text-center">Content restricted to <a href="https://github.com/orgs/warwick-one-metre/teams/observers/">@warwick-one-metre/observers</a>.</span>
    </div>
  </div>
</div>
{% endif %}
{% endblock %}
